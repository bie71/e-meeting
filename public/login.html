<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 64 64%22><circle fill=%222980b9%22 cx=%2232%22 cy=%2232%22 r=%2232%22/><text x=%2232%22 y=%2242%22 font-size=%2232%22 font-family=%22Poppins,sans-serif%22 font-weight=%22700%22 fill=%22white%22 text-anchor=%22middle%22>eM</text></svg>" type="image/svg+xml"/>
<title>Login - eMeeting</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

  *, *::before, *::after {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    padding: 20px;
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(to bottom right, #00aaff, #0047ab);
    color: #333;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
  }

  .container {
    background: #fff;
    border-radius: 12px;
    padding: 30px 30px 35px;
    width: 100%;
    max-width: 400px;
    box-shadow: 0 10px 25px rgba(41, 128, 185, 0.25);
  }

  h2 {
    margin: 0 0 24px;
    color: #0047ab;
    font-weight: 700;
    font-size: 1.9rem;
    text-align: center;
  }

  label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    font-size: 1rem;
    color: #0047ab;
  }

  .input-group {
    margin-bottom: 24px;
  }

  .input-wrapper {
    position: relative;
  }

  input.input-text {
  width: 100%;
  padding: 12px 44px 12px 14px; /* space for eye icon */
  height: 44px;
  border-radius: 8px;
  border: 2px solid #dcdcdc;
  font-size: 1rem;
  color: #333;
  line-height: normal;
  box-sizing: border-box;
  transition: border-color 0.3s;
}

input.input-text:focus {
  outline: none;
  border-color: #2980b9;
  box-shadow: 0 0 8px rgba(41, 128, 185, 0.4);
}



  .toggle-visibility {
    position: absolute;
    top: 30%;
    right: 14px;
    width: 24px;  /* Menjaga ukuran ikon tetap konsisten */
    height: 24px; /* Menjaga ukuran ikon tetap konsisten */
    cursor: pointer;
    user-select: none;
    fill: #666;
    transform: translateY(-50%);
    transition: fill 0.3s ease;
    pointer-events: auto;
    }

    .toggle-visibility svg {
    width: 100%;
    height: 100%;
    }


  .toggle-visibility:hover,
  .toggle-visibility:focus {
    fill: #2980b9;
    outline: none;
  }

  

  button {
    margin: 16px 0 16px 0;
    width: 100%;
    background-color: #0047ab;
    color: white;
    border: none;
    border-radius: 10px;
    padding: 14px;
    font-size: 1.1rem;
    font-weight: 700;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  button:disabled {
    background-color: #95a5a6;
    cursor: not-allowed;
  }

  button:hover:not(:disabled) {
    background-color: #0056b3;
  }

  .success-message {
    margin-top: 18px;
    text-align: center;
    font-weight: 600;
    color: #27ae60;
    text-align: center;
  }

  .error-message {
    color: #e74c3c;
    font-size: 0.9rem;
    margin-top: 16px;
    display: none;
    text-align: center;
  }

  .back-to-home {
  position: fixed;
  top: 20px;
  left: 20px;
  font-size: 0.95rem;
  background-color: #0047ab;
  color: white;
  padding: 10px 18px;
  border-radius: 9999px;
  font-weight: 600;
  text-decoration: none;
  box-shadow: 0 6px 16px rgba(255, 255, 255, 0.4);
  transition: background-color 0.3s ease, box-shadow 0.3s ease;
  z-index: 99;
}

.back-to-home:hover {
  background-color: #0056b3;
  box-shadow: 0 10px 24px rgba(255, 255, 255, 0.6);
}
a.button-link {
  font-size: 1rem;
  padding: 12px 24px;
  background-color: #0047ab;
  color: white;
  border-radius: 9999px;
  font-weight: 700;
  display: inline-block;
  text-decoration: none;
  transition: background-color 0.3s ease, box-shadow 0.3s ease;
  box-shadow: 0 8px 20px rgba(255, 255, 255, 0.6);
}

a.button-link:hover {
  background-color: #0056b3;
  box-shadow: 0 12px 28px rgba(255, 255, 255, 0.85);
}

</style>
</head>
<body>
 <a href="/" class="back-to-home">ðŸ”™ Back To Home</a>
<div class="container" role="main" aria-label="Login form">
  <h2>Login</h2>
  <form id="loginForm" novalidate>
    <div class="input-group">
      <label for="username">Username</label>
      <input type="text" id="username" name="username" class="input-text" required  />

    </div>
    <div class="input-group">
      <label for="password">Password</label>
      <div class="input-wrapper">
        <input type="password" id="password" name="password" class="input-text" required autocomplete="current-password" />
        <div style="text-align: left; margin-top: 5px;">
        <a href="/reset-password.html" 
          style="font-size: 14px; text-decoration: none; color: #007bff;"
            onmouseover="this.style.color='#0047ab'; this.style.textDecoration='underline'"
            onmouseout="this.style.textDecoration='none'; this.style.color='#007bff'">Forgot password?</a>
        </div>

        <svg class="toggle-visibility" id="togglePwd" aria-label="Toggle Password visibility" role="button" tabindex="0" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" >
          <path d="M12 5C7 5 2.73 8.11 1 12c1.73 3.89 6 7 11 7s9.27-3.11 11-7c-1.73-3.89-6-7-11-7z" />
          <circle cx="12" cy="12" r="2.5" />

        </svg>
      </div>
    </div>
    <button type="submit" id="submitBtn">Login</button>
    <div class="error-message" id="errorMsg" role="alert"></div>
    <div style="text-align: center; margin-top: 20px;">
      <span>Not have an account?</span><br />
      <a href="/register.html" class="button-link" style="margin-top: 10px; display: inline-block;">Create Account</a>
    </div>
    
  </form>
</div>

<script>
  (function () {
    const form = document.getElementById("loginForm");
    const submitBtn = document.getElementById("submitBtn");
    const errorMsg = document.getElementById("errorMsg");
    const passwordInput = document.getElementById("password");
    const toggleBtn = document.getElementById("togglePwd");

    const eyePath =
      '<path d="M12 5C7 5 2.73 8.11 1 12c1.73 3.89 6 7 11 7s9.27-3.11 11-7c-1.73-3.89-6-7-11-7z"/><circle cx="12" cy="12" r="2.5"/>';
    const eyeSlashPath =
      '<path d="M17.94 17.94a10.58 10.58 0 01-6 1.56c-5 0-9.27-3.11-11-7a10.69 10.69 0 012.5-3.58M1 1l22 22" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M10.59 13.41a2.5 2.5 0 003.54-3.54" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>';

      toggleBtn.innerHTML = eyePath;

        toggleBtn.addEventListener("click", () => {
        if (passwordInput.type === "password") {
            passwordInput.type = "text";
            toggleBtn.innerHTML = eyeSlashPath;
            toggleBtn.style.fill = "#2980b9";
        } else {
            passwordInput.type = "password";
            toggleBtn.innerHTML = eyePath;
            toggleBtn.style.fill = "#666";
        }
        passwordInput.focus();
        });


    toggleBtn.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        e.preventDefault();
        toggleBtn.click();
      }
    });

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      errorMsg.style.display = "none";

      const username = form.username.value.trim();
      const password = form.password.value.trim();

      if (!username || !password) {
        errorMsg.textContent = "Please enter username and password.";
        errorMsg.style.display = "block";
        return;
      }

      submitBtn.disabled = true;
      submitBtn.textContent = "Logging in...";

      try {
    const response = await fetch(window.location.origin + "/api/v1/auth/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({  username, password })
    });

    const result = await response.json();

    if (!response.ok) {
      throw new Error(result.error || "Login gagal");
    }

    // Simpan token dan user_id ke localStorage
    localStorage.setItem("loginData", JSON.stringify(result));

    // Redirect ke halaman sukses
    window.location.href = "/success.html";
      } catch (error) {
        errorMsg.textContent = error.message;
        errorMsg.style.display = "block";
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = "Login";
      }
    });
  })();
</script>
</body>
</html>
